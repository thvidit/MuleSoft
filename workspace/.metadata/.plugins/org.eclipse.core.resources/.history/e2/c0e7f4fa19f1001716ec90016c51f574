package com.football.java;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.Statement;

import javax.jws.WebService;

import org.json.JSONArray;
import org.json.JSONObject;

import com.football.database.Database;

@WebService(endpointInterface="com.football.java.MethodsInterface", serviceName="getAllMatches")
public class MethodsImplementation implements MethodsInterface{

	Database db = new Database();
	
	@Override
	public ResultSet getAllMatches() {
		try {
			Connection conn =  db.getConnection();
			Statement stmt = conn.createStatement();
			String query = "SELECT * FROM MATCHES";
			ResultSet rs = stmt.executeQuery(query);
			while(rs.next()){
				System.out.println("Resultset is: " + rs.getInt(1));
			}
			return rs;
		} catch (Exception e) {
			e.printStackTrace();
			return null;
		}
		
	}

	@Override
	public ResultSet getMatches(String team) {
		try {
			Connection conn =  db.getConnection();
			Statement stmt = conn.createStatement();
			String query = "SELECT * FROM MATCHES where team_id= '" + team +"'";
			ResultSet rs = stmt.executeQuery(query);
			return rs;
		} catch (Exception e) {
			e.printStackTrace();
			return null;
		}
		
	}
	
	public static JSONArray convertToJSON(ResultSet resultSet)
            throws Exception {
        JSONArray jsonArray = new JSONArray();
        while (resultSet.next()) {
            int total_rows = resultSet.getMetaData().getColumnCount();
            for (int i = 0; i < total_rows; i++) {
                JSONObject obj = new JSONObject();
                obj.put(resultSet.getMetaData().getColumnLabel(i + 1)
                        .toLowerCase(), resultSet.getObject(i + 1));
                jsonArray.put(obj);
            }
        }
        return jsonArray;
    }

	/*@Override
	public boolean addMatch(Match match) {
		
		
	}*/
}
