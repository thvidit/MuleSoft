package com.football.java;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.Statement;
import org.mule.api.MuleEventContext;
import javax.jws.WebService;

import org.mule.DefaultMuleMessage;
import org.mule.api.MuleMessage;

import com.football.database.Database;

@WebService(endpointInterface="com.football.java.MethodsInterface",serviceName="getAllMatches")
public class MethodsImplementation implements MethodsInterface{

	Database db = new Database();
	
	
	@Override
	public String getAllMatches() {
		try {
			Connection conn =  db.getConnection();
			Statement stmt = conn.createStatement();
			String query = "SELECT * RFOM MATCHES";
			ResultSet rs = stmt.executeQuery(query);
			System.out.println("Resultset is: " + rs.toString());
			/*MuleMessage output = new DefaultMuleMessage(rs,context.getMuleContext());
			output.setEncoding("UTF-8");
			output.setPayload(rs.toString()); */
			return rs.toString();
		} catch (Exception e) {
			e.printStackTrace();
			return null;
		}
		
	}

	@Override
	public String getMatches(String team) {
		try {
			Connection conn =  db.getConnection();
			Statement stmt = conn.createStatement();
			String query = "SELECT * RFOM MATCHES where team_id= '" + team +"'";
			ResultSet rs = stmt.executeQuery(query);
			return rs.toString();
		} catch (Exception e) {
			e.printStackTrace();
			return null;
		}
		
	}

	/*@Override
	public boolean addMatch(Match match) {
		
		
	}*/
}
